<!DOCTYPE html>
<html lang="bn">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Note Books apps</title>

        <script src="https://cdn.tailwindcss.com"></script>


        <script>
            // ✅ BASE_URL চেক (localhost ও 127.0.0.1 উভয় handle করা)
            const BASE_URL = ["localhost", "127.0.0.1"].includes(window.location.hostname)
                ? "http://localhost:3000"
                : "https://notebook-app.up.railway.app";

            // ✅ Add a new note
            async function addNote() {
                const noteInput = document.getElementById("note");
                const note = noteInput.value.trim();

                if (!note) {
                    return alert("Note cannot be empty!");
                }

                try {
                    const res = await fetch(`${BASE_URL}/notes`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ note })
                    });

                    const data = await res.json();

                    if (!res.ok) {
                        return alert("Failed to add note: " + (data.error || "Unknown error"));
                    }

                    // Clear input after successful add
                    noteInput.value = "";
                    loadNotes();

                } catch (err) {
                    console.error("❌ Error adding note:", err);
                    alert("Server error. Check console for details.");
                }
            }

            // ✅ Load all notes
            async function loadNotes() {
                try {
                    const res = await fetch(`${BASE_URL}/notes`);
                    const notes = await res.json();

                    if (!Array.isArray(notes)) {
                        return alert("Failed to load notes from server.");
                    }

                    const notesList = document.getElementById("notesList");
                    if (notes.length === 0) {
                        notesList.innerHTML = "<li>No notes yet!</li>";
                    } else {
                        notesList.innerHTML = notes.map(n => `<li>${n.note}</li>`).join("");
                    }

                } catch (err) {
                    console.error("❌ Error loading notes:", err);
                    alert("Server error while loading notes. Check console.");
                }
            }

            // ✅ Load notes on page load
            window.onload = loadNotes;
        </script>


    </head>
    <body class="h-screen bg-black px-16 py-8 font-poppins">
        <div class="h-full bg-gray-900 text-white flex flex-col p-16 border border-purple-700"> 
            <div class="w-full flex flex-col items-center p-16">
                <h1 class="text-2xl font-semibold mb-8 underline decoration-gray-300 underline-offset-8 opacity-80">Notebook apps</h1>
                <textarea id="note" class="border p-2 w-full h-32 rounded text-black shadow-2xl shadow-purple focus:outline-none focus:ring-2 focus:ring-purple-600" rows="3" cols="30" placeholder="write notes here"></textarea><br>
                <button onclick="addNote()" class="bg-blue-500 px-4 py-2 rounded mt-2 w-32">Add Note</button>
            </div>
            <h2 class="text-xl pl-16 text-white mt-2 opacity-80">All notes are:</h2>
            <div class="px-16 overflow-y-auto rounded-lg shadow-2xl shadow-purple">
                <div class="bg-white text-black text-center h-auto w-full rounded-xl p-4">
                    <ul id="notesList" class="mt-2"></ul>
                </div>
            </div>
        </div>
    </body>
</html>

